[build]
  builder = "NIXPACKS"
  buildCommand = "python -m pip install --upgrade pip && pip install -r requirements.txt"
  publish = "staticfiles"

[deploy]
  startCommand = "chmod +x entrypoint.sh && ./entrypoint.sh"
  healthcheckPath = "/health/"
  healthcheckTimeout = 10  # 10 segundos de espera para el healthcheck
  healthcheckInterval = 10  # Intervalo entre reintentos
  restartDelay = 5  # 5 segundos de espera entre reinicios
  restartMax = 3
  restartTimeout = 120
  restartWindow = 300
  zeroDowntime = false

[build.environment]
  PYTHON_VERSION = "3.11.4"
  NODE_VERSION = "18"

[deploy.environment]
  # Configuraci贸n de Django
  DEBUG = "True"
  DJANGO_SETTINGS_MODULE = "mascotas_perdidas.settings"
  SECRET_KEY = "your-secret-key-here"
  ALLOWED_HOSTS = "*"
  CSRF_TRUSTED_ORIGINS = "https://*.railway.app"
  
  # Puerto
  PORT = "8000"
  
  # Configuraci贸n de Gunicorn
  GUNICORN_CMD_ARGS = "--workers=1 --timeout=120 --access-logfile - --error-logfile - --log-level=debug"
  
  # Configuraci贸n de WhiteNoise
  STATICFILES_STORAGE = "whitenoise.storage.CompressedManifestStaticFilesStorage"
  
  # Configuraci贸n adicional
  PYTHONUNBUFFERED = "1"
  PYTHONHASHSEED = "random"
  PYTHONDONTWRITEBYTECODE = "1"
  
  # Deshabilitar SSL para desarrollo
  SECURE_SSL_REDIRECT = "False"
  SESSION_COOKIE_SECURE = "False"
  CSRF_COOKIE_SECURE = "False"
